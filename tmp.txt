[@@@ocaml.ppx.context
  {
    tool_name = "ppx_driver";
    include_dirs = [];
    hidden_include_dirs = [];
    load_path = ([], []);
    open_modules = [];
    for_package = None;
    debug = false;
    use_threads = false;
    use_vmthreads = false;
    recursive_types = false;
    principal = false;
    no_alias_deps = false;
    unboxed_types = false;
    unsafe_string = false;
    cookies = [("library-name", "khasmc"); ("sedlex.regexps", ([%regexps ]))]
  }]
open Share.Uuid
open Share.Maybe
type resolved =
  | R of string * string [@@deriving show { with_path = false }]
include
  struct
    let _ = fun (_ : resolved) -> ()
    let rec (pp_resolved :
              Ppx_deriving_runtime.Format.formatter ->
                resolved -> Ppx_deriving_runtime.unit)
      =
      ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
          fun fmt ->
            function
            | R (a0, a1) ->
                (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>R (@,";
                 ((Ppx_deriving_runtime.Format.fprintf fmt "%S") a0;
                  Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                  (Ppx_deriving_runtime.Format.fprintf fmt "%S") a1);
                 Ppx_deriving_runtime.Format.fprintf fmt "@,))@]"))
      [@ocaml.warning "-39"][@ocaml.warning "-A"])
    and (show_resolved : resolved -> Ppx_deriving_runtime.string) =
      fun x -> Ppx_deriving_runtime.Format.asprintf "%a" pp_resolved x
    [@@ocaml.warning "-32"]
    let _ = pp_resolved
    and _ = show_resolved
  end[@@ocaml.doc "@inline"][@@merlin.hide ]
let fresh_resolved =
  let i = ref (-10) in fun () -> decr i; R ((string_of_int (!i)), "(GEN)")
let rec n_fresh_resolved n =
  if n <= 0
  then []
  else (let f = fresh_resolved () in f :: (n_fresh_resolved (n - 1)))
let resolved_using =
  let i = ref 10 in
  fun nm -> incr i; R ((nm ^ ("@" ^ (string_of_int (!i)))), nm)
type unresolved =
  | U of string [@@deriving show { with_path = false }]
include
  struct
    let _ = fun (_ : unresolved) -> ()
    let rec (pp_unresolved :
              Ppx_deriving_runtime.Format.formatter ->
                unresolved -> Ppx_deriving_runtime.unit)
      =
      ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
          fun fmt ->
            function
            | U a0 ->
                (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>U@ ";
                 (Ppx_deriving_runtime.Format.fprintf fmt "%S") a0;
                 Ppx_deriving_runtime.Format.fprintf fmt "@])"))
      [@ocaml.warning "-39"][@ocaml.warning "-A"])
    and (show_unresolved : unresolved -> Ppx_deriving_runtime.string) =
      fun x -> Ppx_deriving_runtime.Format.asprintf "%a" pp_unresolved x
    [@@ocaml.warning "-32"]
    let _ = pp_unresolved
    and _ = show_unresolved
  end[@@ocaml.doc "@inline"][@@merlin.hide ]
type 'a meta =
  | Unresolved 
  | Resolved of 'a typ [@@deriving show { with_path = false }]
and 'a typ =
  | TyBottom 
  | TyInt 
  | TyString 
  | TyChar 
  | TyFloat 
  | TyBool 
  | TyTuple of 'a typ list 
  | TyArrow of 'a typ * 'a typ 
  | TyPoly of 'a 
  | TyCustom of 'a * 'a typ list 
  | TyRef of 'a typ 
  | TyMeta of 'a meta ref [@@deriving show { with_path = false }]
and 'a field = ('a * 'a typ)[@@deriving show { with_path = false }]
include
  struct
    let _ = fun (_ : 'a meta) -> ()
    let _ = fun (_ : 'a typ) -> ()
    let _ = fun (_ : 'a field) -> ()
    let rec (pp_meta :
              'a .
                (Ppx_deriving_runtime.Format.formatter ->
                   'a -> Ppx_deriving_runtime.unit)
                  ->
                  Ppx_deriving_runtime.Format.formatter ->
                    'a meta -> Ppx_deriving_runtime.unit)
      =
      ((let __0 = pp_typ in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun fmt ->
                function
                | Unresolved ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt
                      "Unresolved"
                | Resolved a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>Resolved@ ";
                     (__0 (fun fmt -> poly_a fmt) fmt) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])"))
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_meta :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              -> 'a meta -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun x -> Ppx_deriving_runtime.Format.asprintf "%a" (pp_meta poly_a) x
    [@@ocaml.warning "-32"]
    and (pp_typ :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              ->
              Ppx_deriving_runtime.Format.formatter ->
                'a typ -> Ppx_deriving_runtime.unit)
      =
      ((let __5 = pp_meta
        and __4 = pp_typ
        and __3 = pp_typ
        and __2 = pp_typ
        and __1 = pp_typ
        and __0 = pp_typ in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun fmt ->
                function
                | TyBottom ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt
                      "TyBottom"
                | TyInt ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt "TyInt"
                | TyString ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt
                      "TyString"
                | TyChar ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt "TyChar"
                | TyFloat ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt "TyFloat"
                | TyBool ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt "TyBool"
                | TyTuple a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>TyTuple@ ";
                     ((fun x ->
                         Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                         ignore
                           (List.fold_left
                              (fun sep x ->
                                 if sep
                                 then
                                   Ppx_deriving_runtime.Format.fprintf fmt
                                     ";@ ";
                                 (__0 (fun fmt -> poly_a fmt) fmt) x;
                                 true) false x);
                         Ppx_deriving_runtime.Format.fprintf fmt "@,]@]")) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])")
                | TyArrow (a0, a1) ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>TyArrow (@,";
                     ((__1 (fun fmt -> poly_a fmt) fmt) a0;
                      Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                      (__2 (fun fmt -> poly_a fmt) fmt) a1);
                     Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                | TyPoly a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>TyPoly@ ";
                     (poly_a fmt) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])")
                | TyCustom (a0, a1) ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>TyCustom (@,";
                     ((poly_a fmt) a0;
                      Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                      ((fun x ->
                          Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                          ignore
                            (List.fold_left
                               (fun sep x ->
                                  if sep
                                  then
                                    Ppx_deriving_runtime.Format.fprintf fmt
                                      ";@ ";
                                  (__3 (fun fmt -> poly_a fmt) fmt) x;
                                  true) false x);
                          Ppx_deriving_runtime.Format.fprintf fmt "@,]@]"))
                        a1);
                     Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                | TyRef a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>TyRef@ ";
                     (__4 (fun fmt -> poly_a fmt) fmt) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])")
                | TyMeta a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>TyMeta@ ";
                     ((fun x ->
                         Ppx_deriving_runtime.Format.pp_print_string fmt
                           "ref (";
                         (__5 (fun fmt -> poly_a fmt) fmt) (!x);
                         Ppx_deriving_runtime.Format.pp_print_string fmt ")"))
                       a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])"))
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_typ :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              -> 'a typ -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun x -> Ppx_deriving_runtime.Format.asprintf "%a" (pp_typ poly_a) x
    [@@ocaml.warning "-32"]
    and (pp_field :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              ->
              Ppx_deriving_runtime.Format.formatter ->
                'a field -> Ppx_deriving_runtime.unit)
      =
      ((let __0 = pp_typ in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun fmt (a0, a1) ->
                Ppx_deriving_runtime.Format.fprintf fmt "(@[";
                ((poly_a fmt) a0;
                 Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                 (__0 (fun fmt -> poly_a fmt) fmt) a1);
                Ppx_deriving_runtime.Format.fprintf fmt "@])")
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_field :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              -> 'a field -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun x ->
          Ppx_deriving_runtime.Format.asprintf "%a" (pp_field poly_a) x
    [@@ocaml.warning "-32"]
    let _ = pp_meta
    and _ = show_meta
    and _ = pp_typ
    and _ = show_typ
    and _ = pp_field
    and _ = show_field
    let rec (pp_meta :
              'a .
                (Ppx_deriving_runtime.Format.formatter ->
                   'a -> Ppx_deriving_runtime.unit)
                  ->
                  Ppx_deriving_runtime.Format.formatter ->
                    'a meta -> Ppx_deriving_runtime.unit)
      =
      ((let __0 = pp_typ in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun fmt ->
                function
                | Unresolved ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt
                      "Unresolved"
                | Resolved a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>Resolved@ ";
                     (__0 (fun fmt -> poly_a fmt) fmt) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])"))
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_meta :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              -> 'a meta -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun x -> Ppx_deriving_runtime.Format.asprintf "%a" (pp_meta poly_a) x
    [@@ocaml.warning "-32"]
    and (pp_typ :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              ->
              Ppx_deriving_runtime.Format.formatter ->
                'a typ -> Ppx_deriving_runtime.unit)
      =
      ((let __5 = pp_meta
        and __4 = pp_typ
        and __3 = pp_typ
        and __2 = pp_typ
        and __1 = pp_typ
        and __0 = pp_typ in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun fmt ->
                function
                | TyBottom ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt
                      "TyBottom"
                | TyInt ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt "TyInt"
                | TyString ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt
                      "TyString"
                | TyChar ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt "TyChar"
                | TyFloat ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt "TyFloat"
                | TyBool ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt "TyBool"
                | TyTuple a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>TyTuple@ ";
                     ((fun x ->
                         Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                         ignore
                           (List.fold_left
                              (fun sep x ->
                                 if sep
                                 then
                                   Ppx_deriving_runtime.Format.fprintf fmt
                                     ";@ ";
                                 (__0 (fun fmt -> poly_a fmt) fmt) x;
                                 true) false x);
                         Ppx_deriving_runtime.Format.fprintf fmt "@,]@]")) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])")
                | TyArrow (a0, a1) ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>TyArrow (@,";
                     ((__1 (fun fmt -> poly_a fmt) fmt) a0;
                      Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                      (__2 (fun fmt -> poly_a fmt) fmt) a1);
                     Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                | TyPoly a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>TyPoly@ ";
                     (poly_a fmt) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])")
                | TyCustom (a0, a1) ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>TyCustom (@,";
                     ((poly_a fmt) a0;
                      Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                      ((fun x ->
                          Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                          ignore
                            (List.fold_left
                               (fun sep x ->
                                  if sep
                                  then
                                    Ppx_deriving_runtime.Format.fprintf fmt
                                      ";@ ";
                                  (__3 (fun fmt -> poly_a fmt) fmt) x;
                                  true) false x);
                          Ppx_deriving_runtime.Format.fprintf fmt "@,]@]"))
                        a1);
                     Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                | TyRef a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>TyRef@ ";
                     (__4 (fun fmt -> poly_a fmt) fmt) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])")
                | TyMeta a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>TyMeta@ ";
                     ((fun x ->
                         Ppx_deriving_runtime.Format.pp_print_string fmt
                           "ref (";
                         (__5 (fun fmt -> poly_a fmt) fmt) (!x);
                         Ppx_deriving_runtime.Format.pp_print_string fmt ")"))
                       a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])"))
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_typ :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              -> 'a typ -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun x -> Ppx_deriving_runtime.Format.asprintf "%a" (pp_typ poly_a) x
    [@@ocaml.warning "-32"]
    and (pp_field :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              ->
              Ppx_deriving_runtime.Format.formatter ->
                'a field -> Ppx_deriving_runtime.unit)
      =
      ((let __0 = pp_typ in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun fmt (a0, a1) ->
                Ppx_deriving_runtime.Format.fprintf fmt "(@[";
                ((poly_a fmt) a0;
                 Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                 (__0 (fun fmt -> poly_a fmt) fmt) a1);
                Ppx_deriving_runtime.Format.fprintf fmt "@])")
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_field :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              -> 'a field -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun x ->
          Ppx_deriving_runtime.Format.asprintf "%a" (pp_field poly_a) x
    [@@ocaml.warning "-32"]
    let _ = pp_meta
    and _ = show_meta
    and _ = pp_typ
    and _ = show_typ
    and _ = pp_field
    and _ = show_field
    let rec (pp_meta :
              'a .
                (Ppx_deriving_runtime.Format.formatter ->
                   'a -> Ppx_deriving_runtime.unit)
                  ->
                  Ppx_deriving_runtime.Format.formatter ->
                    'a meta -> Ppx_deriving_runtime.unit)
      =
      ((let __0 = pp_typ in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun fmt ->
                function
                | Unresolved ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt
                      "Unresolved"
                | Resolved a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>Resolved@ ";
                     (__0 (fun fmt -> poly_a fmt) fmt) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])"))
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_meta :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              -> 'a meta -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun x -> Ppx_deriving_runtime.Format.asprintf "%a" (pp_meta poly_a) x
    [@@ocaml.warning "-32"]
    and (pp_typ :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              ->
              Ppx_deriving_runtime.Format.formatter ->
                'a typ -> Ppx_deriving_runtime.unit)
      =
      ((let __5 = pp_meta
        and __4 = pp_typ
        and __3 = pp_typ
        and __2 = pp_typ
        and __1 = pp_typ
        and __0 = pp_typ in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun fmt ->
                function
                | TyBottom ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt
                      "TyBottom"
                | TyInt ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt "TyInt"
                | TyString ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt
                      "TyString"
                | TyChar ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt "TyChar"
                | TyFloat ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt "TyFloat"
                | TyBool ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt "TyBool"
                | TyTuple a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>TyTuple@ ";
                     ((fun x ->
                         Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                         ignore
                           (List.fold_left
                              (fun sep x ->
                                 if sep
                                 then
                                   Ppx_deriving_runtime.Format.fprintf fmt
                                     ";@ ";
                                 (__0 (fun fmt -> poly_a fmt) fmt) x;
                                 true) false x);
                         Ppx_deriving_runtime.Format.fprintf fmt "@,]@]")) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])")
                | TyArrow (a0, a1) ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>TyArrow (@,";
                     ((__1 (fun fmt -> poly_a fmt) fmt) a0;
                      Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                      (__2 (fun fmt -> poly_a fmt) fmt) a1);
                     Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                | TyPoly a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>TyPoly@ ";
                     (poly_a fmt) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])")
                | TyCustom (a0, a1) ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>TyCustom (@,";
                     ((poly_a fmt) a0;
                      Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                      ((fun x ->
                          Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                          ignore
                            (List.fold_left
                               (fun sep x ->
                                  if sep
                                  then
                                    Ppx_deriving_runtime.Format.fprintf fmt
                                      ";@ ";
                                  (__3 (fun fmt -> poly_a fmt) fmt) x;
                                  true) false x);
                          Ppx_deriving_runtime.Format.fprintf fmt "@,]@]"))
                        a1);
                     Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                | TyRef a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>TyRef@ ";
                     (__4 (fun fmt -> poly_a fmt) fmt) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])")
                | TyMeta a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>TyMeta@ ";
                     ((fun x ->
                         Ppx_deriving_runtime.Format.pp_print_string fmt
                           "ref (";
                         (__5 (fun fmt -> poly_a fmt) fmt) (!x);
                         Ppx_deriving_runtime.Format.pp_print_string fmt ")"))
                       a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])"))
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_typ :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              -> 'a typ -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun x -> Ppx_deriving_runtime.Format.asprintf "%a" (pp_typ poly_a) x
    [@@ocaml.warning "-32"]
    and (pp_field :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              ->
              Ppx_deriving_runtime.Format.formatter ->
                'a field -> Ppx_deriving_runtime.unit)
      =
      ((let __0 = pp_typ in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun fmt (a0, a1) ->
                Ppx_deriving_runtime.Format.fprintf fmt "(@[";
                ((poly_a fmt) a0;
                 Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                 (__0 (fun fmt -> poly_a fmt) fmt) a1);
                Ppx_deriving_runtime.Format.fprintf fmt "@])")
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_field :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              -> 'a field -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun x ->
          Ppx_deriving_runtime.Format.asprintf "%a" (pp_field poly_a) x
    [@@ocaml.warning "-32"]
    let _ = pp_meta
    and _ = show_meta
    and _ = pp_typ
    and _ = show_typ
    and _ = pp_field
    and _ = show_field
  end[@@ocaml.doc "@inline"][@@merlin.hide ]
let rec regeneralize (nw : unit -> 'a) (ty : 'a typ) =
  let f = regeneralize nw in
  match ty with
  | TyTuple t -> TyTuple (List.map f t)
  | TyArrow (a, b) -> TyArrow ((f a), (f b))
  | TyCustom (c, t) -> TyCustom (c, (List.map f t))
  | TyRef r -> TyRef (f r)
  | TyMeta m ->
      TyMeta
        (ref
           (match !m with
            | Resolved m -> Resolved m
            | Unresolved ->
                (m := (Resolved (TyPoly (nw ()))); Resolved (TyMeta m))))
  | _ -> ty
let rec force (t : 'a typ) : 'a typ=
  match (t : 'a typ) with
  | TyTuple t -> TyTuple (List.map force t)
  | TyArrow (a, b) -> TyArrow ((force a), (force b))
  | TyCustom (a, b) -> TyCustom (a, (List.map force b))
  | TyRef a -> TyRef (force a)
  | TyMeta m -> (match !m with | Unresolved -> t | Resolved t -> force t)
  | _ -> t
let get_polys t =
  let rec g t =
    match force t with
    | TyTuple t -> (List.map g t) |> List.flatten
    | TyArrow (a, b) -> (g a) @ (g b)
    | TyCustom (_, t) -> (List.map g t) |> List.flatten
    | TyRef r -> g r
    | TyPoly a -> [a]
    | _ -> [] in
  g t
let rec instantiate (map : ('a * 'a typ) list) (t : 'a typ) : 'a typ=
  let f = instantiate map in
  match force (t : 'a typ) with
  | TyTuple t -> TyTuple (List.map f t)
  | TyArrow (a, b) -> TyArrow ((f a), (f b))
  | TyPoly x ->
      (match List.assoc_opt x map with | Some n -> n | None -> TyPoly x)
  | TyCustom (x, t) -> TyCustom (x, (List.map f t))
  | TyRef t -> TyRef (f t)
  | _ -> t
let make_metas polys metas =
  (List.map
     (fun x ->
        if not @@ (List.mem x polys)
        then [(x, (TyMeta (ref Unresolved)))]
        else []) metas)
    |> List.flatten
let to_metas polys t =
  let metas = get_polys t in
  let map = make_metas polys metas in instantiate map t
let to_metas' polys t =
  let metas = get_polys t in
  let map = make_metas polys metas in ((instantiate map t), map)
let rec back_to_polys gen t =
  let f = back_to_polys gen in
  match force t with
  | TyTuple t -> TyTuple (List.map f t)
  | TyArrow (q, w) -> TyArrow ((f q), (f w))
  | TyCustom (x, t) -> TyCustom (x, (List.map f t))
  | TyRef t -> TyRef (f t)
  | TyMeta m ->
      (match !m with
       | Resolved _ -> failwith "impossible"
       | Unresolved -> (m := (Resolved (TyPoly (gen ()))); t))
  | t -> t
let rec subst_polys (map : ('a * 'a typ) list) (x : 'a typ) : 'a typ=
  let f = subst_polys map in
  match force (x : 'a typ) with
  | TyTuple t -> TyTuple (List.map f t)
  | TyArrow (a, b) -> TyArrow ((f a), (f b))
  | TyPoly k -> (match List.assoc_opt k map with | Some t -> t | None -> x)
  | TyCustom (a, bnd) -> TyCustom (a, (List.map f bnd))
  | TyRef r -> TyRef (f r)
  | TyMeta m -> x
  | _ -> x
let rec match_polys bef aft : 'a list=
  match ((force bef), (force aft)) with
  | (a, b) when a = b -> []
  | (TyTuple a, TyTuple b) -> List.flatten (List.map2 match_polys a b)
  | (TyArrow (a, b), TyArrow (q, w)) -> (match_polys a q) @ (match_polys b w)
  | (TyCustom (_, xs), TyCustom (_, ys)) ->
      List.flatten (List.map2 match_polys xs ys)
  | (TyRef a, TyRef b) -> match_polys a b
  | (TyPoly a, b) | (b, TyPoly a) -> [(a, b)]
  | (a, b) ->
      (print_endline (show_typ pp_resolved a);
       print_endline (show_typ pp_resolved b);
       failwith "match_polys bad")
type literal =
  | LBool of bool 
  | LInt of string [@@deriving show { with_path = false }]
include
  struct
    let _ = fun (_ : literal) -> ()
    let rec (pp_literal :
              Ppx_deriving_runtime.Format.formatter ->
                literal -> Ppx_deriving_runtime.unit)
      =
      ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
          fun fmt ->
            function
            | LBool a0 ->
                (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>LBool@ ";
                 (Ppx_deriving_runtime.Format.fprintf fmt "%B") a0;
                 Ppx_deriving_runtime.Format.fprintf fmt "@])")
            | LInt a0 ->
                (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>LInt@ ";
                 (Ppx_deriving_runtime.Format.fprintf fmt "%S") a0;
                 Ppx_deriving_runtime.Format.fprintf fmt "@])"))
      [@ocaml.warning "-39"][@ocaml.warning "-A"])
    and (show_literal : literal -> Ppx_deriving_runtime.string) =
      fun x -> Ppx_deriving_runtime.Format.asprintf "%a" pp_literal x
    [@@ocaml.warning "-32"]
    let _ = pp_literal
    and _ = show_literal
  end[@@ocaml.doc "@inline"][@@merlin.hide ]
type 'a case =
  | CaseWild 
  | CaseVar of 'a 
  | CaseTuple of 'a case list 
  | CaseCtor of 'a * 'a case list 
  | CaseLit of literal [@@deriving show { with_path = false }]
include
  struct
    let _ = fun (_ : 'a case) -> ()
    let rec (pp_case :
              'a .
                (Ppx_deriving_runtime.Format.formatter ->
                   'a -> Ppx_deriving_runtime.unit)
                  ->
                  Ppx_deriving_runtime.Format.formatter ->
                    'a case -> Ppx_deriving_runtime.unit)
      =
      ((let __2 = pp_literal
        and __1 = pp_case
        and __0 = pp_case in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun fmt ->
                function
                | CaseWild ->
                    Ppx_deriving_runtime.Format.pp_print_string fmt
                      "CaseWild"
                | CaseVar a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>CaseVar@ ";
                     (poly_a fmt) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])")
                | CaseTuple a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>CaseTuple@ ";
                     ((fun x ->
                         Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                         ignore
                           (List.fold_left
                              (fun sep x ->
                                 if sep
                                 then
                                   Ppx_deriving_runtime.Format.fprintf fmt
                                     ";@ ";
                                 (__0 (fun fmt -> poly_a fmt) fmt) x;
                                 true) false x);
                         Ppx_deriving_runtime.Format.fprintf fmt "@,]@]")) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])")
                | CaseCtor (a0, a1) ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>CaseCtor (@,";
                     ((poly_a fmt) a0;
                      Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                      ((fun x ->
                          Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                          ignore
                            (List.fold_left
                               (fun sep x ->
                                  if sep
                                  then
                                    Ppx_deriving_runtime.Format.fprintf fmt
                                      ";@ ";
                                  (__1 (fun fmt -> poly_a fmt) fmt) x;
                                  true) false x);
                          Ppx_deriving_runtime.Format.fprintf fmt "@,]@]"))
                        a1);
                     Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                | CaseLit a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt
                       "(@[<2>CaseLit@ ";
                     (__2 fmt) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])"))
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_case :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              -> 'a case -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun x -> Ppx_deriving_runtime.Format.asprintf "%a" (pp_case poly_a) x
    [@@ocaml.warning "-32"]
    let _ = pp_case
    and _ = show_case
  end[@@ocaml.doc "@inline"][@@merlin.hide ]
let rec case_names (c : 'a case) : 'a list=
  match c with
  | CaseWild -> []
  | CaseVar c -> [c]
  | CaseTuple t -> List.flatten (List.map case_names t)
  | CaseCtor (c, t) -> List.flatten (List.map case_names t)
  | CaseLit _ -> []
type 'a data =
  {
  uuid: 'a uuid ;
  mutable counter: int ;
  span: (string * int * int) option }[@@deriving show { with_path = false }]
include
  struct
    let _ = fun (_ : 'a data) -> ()
    let rec (pp_data :
              'a .
                (Ppx_deriving_runtime.Format.formatter ->
                   'a -> Ppx_deriving_runtime.unit)
                  ->
                  Ppx_deriving_runtime.Format.formatter ->
                    'a data -> Ppx_deriving_runtime.unit)
      =
      ((let __0 = pp_uuid in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun fmt x ->
                Ppx_deriving_runtime.Format.fprintf fmt "@[<2>{ ";
                (((Ppx_deriving_runtime.Format.fprintf fmt "@[%s =@ " "uuid";
                   (__0 (fun fmt -> poly_a fmt) fmt) x.uuid;
                   Ppx_deriving_runtime.Format.fprintf fmt "@]");
                  Ppx_deriving_runtime.Format.fprintf fmt ";@ ";
                  Ppx_deriving_runtime.Format.fprintf fmt "@[%s =@ "
                    "counter";
                  (Ppx_deriving_runtime.Format.fprintf fmt "%d") x.counter;
                  Ppx_deriving_runtime.Format.fprintf fmt "@]");
                 Ppx_deriving_runtime.Format.fprintf fmt ";@ ";
                 Ppx_deriving_runtime.Format.fprintf fmt "@[%s =@ " "span";
                 ((function
                   | None ->
                       Ppx_deriving_runtime.Format.pp_print_string fmt "None"
                   | Some x ->
                       (Ppx_deriving_runtime.Format.pp_print_string fmt
                          "(Some ";
                        ((fun (a0, a1, a2) ->
                            Ppx_deriving_runtime.Format.fprintf fmt "(@[";
                            (((Ppx_deriving_runtime.Format.fprintf fmt "%S")
                                a0;
                              Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                              (Ppx_deriving_runtime.Format.fprintf fmt "%d")
                                a1);
                             Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                             (Ppx_deriving_runtime.Format.fprintf fmt "%d")
                               a2);
                            Ppx_deriving_runtime.Format.fprintf fmt "@])")) x;
                        Ppx_deriving_runtime.Format.pp_print_string fmt ")")))
                   x.span;
                 Ppx_deriving_runtime.Format.fprintf fmt "@]");
                Ppx_deriving_runtime.Format.fprintf fmt "@ }@]")
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_data :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              -> 'a data -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun x -> Ppx_deriving_runtime.Format.asprintf "%a" (pp_data poly_a) x
    [@@ocaml.warning "-32"]
    let _ = pp_data
    and _ = show_data
  end[@@ocaml.doc "@inline"][@@merlin.hide ]
let data () = { uuid = (Share.Uuid.uuid ()); counter = 0; span = None }
let data_of uuid = { uuid; counter = 0; span = None }
let update_data_uuid data nw =
  { data with uuid = (uuid_set_snd nw data.uuid) }
type binop =
  | Add 
  | Sub 
  | Mul 
  | Div 
  | LAnd 
  | LOr 
  | Lt 
  | Gt 
  | LtEq 
  | GtEq 
  | Eq [@@deriving show { with_path = false }]
include
  struct
    let _ = fun (_ : binop) -> ()
    let rec (pp_binop :
              Ppx_deriving_runtime.Format.formatter ->
                binop -> Ppx_deriving_runtime.unit)
      =
      ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
          fun fmt ->
            function
            | Add -> Ppx_deriving_runtime.Format.pp_print_string fmt "Add"
            | Sub -> Ppx_deriving_runtime.Format.pp_print_string fmt "Sub"
            | Mul -> Ppx_deriving_runtime.Format.pp_print_string fmt "Mul"
            | Div -> Ppx_deriving_runtime.Format.pp_print_string fmt "Div"
            | LAnd -> Ppx_deriving_runtime.Format.pp_print_string fmt "LAnd"
            | LOr -> Ppx_deriving_runtime.Format.pp_print_string fmt "LOr"
            | Lt -> Ppx_deriving_runtime.Format.pp_print_string fmt "Lt"
            | Gt -> Ppx_deriving_runtime.Format.pp_print_string fmt "Gt"
            | LtEq -> Ppx_deriving_runtime.Format.pp_print_string fmt "LtEq"
            | GtEq -> Ppx_deriving_runtime.Format.pp_print_string fmt "GtEq"
            | Eq -> Ppx_deriving_runtime.Format.pp_print_string fmt "Eq")
      [@ocaml.warning "-39"][@ocaml.warning "-A"])
    and (show_binop : binop -> Ppx_deriving_runtime.string) =
      fun x -> Ppx_deriving_runtime.Format.asprintf "%a" pp_binop x[@@ocaml.warning
                                                                    "-32"]
    let _ = pp_binop
    and _ = show_binop
  end[@@ocaml.doc "@inline"][@@merlin.hide ]
type unaryop =
  | Negate 
  | BNegate 
  | Ref 
  | GetRecField of string 
  | GetConstrField of int 
  | Project of int [@@deriving show { with_path = false }]
include
  struct
    let _ = fun (_ : unaryop) -> ()
    let rec (pp_unaryop :
              Ppx_deriving_runtime.Format.formatter ->
                unaryop -> Ppx_deriving_runtime.unit)
      =
      ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
          fun fmt ->
            function
            | Negate ->
                Ppx_deriving_runtime.Format.pp_print_string fmt "Negate"
            | BNegate ->
                Ppx_deriving_runtime.Format.pp_print_string fmt "BNegate"
            | Ref -> Ppx_deriving_runtime.Format.pp_print_string fmt "Ref"
            | GetRecField a0 ->
                (Ppx_deriving_runtime.Format.fprintf fmt
                   "(@[<2>GetRecField@ ";
                 (Ppx_deriving_runtime.Format.fprintf fmt "%S") a0;
                 Ppx_deriving_runtime.Format.fprintf fmt "@])")
            | GetConstrField a0 ->
                (Ppx_deriving_runtime.Format.fprintf fmt
                   "(@[<2>GetConstrField@ ";
                 (Ppx_deriving_runtime.Format.fprintf fmt "%d") a0;
                 Ppx_deriving_runtime.Format.fprintf fmt "@])")
            | Project a0 ->
                (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>Project@ ";
                 (Ppx_deriving_runtime.Format.fprintf fmt "%d") a0;
                 Ppx_deriving_runtime.Format.fprintf fmt "@])"))
      [@ocaml.warning "-39"][@ocaml.warning "-A"])
    and (show_unaryop : unaryop -> Ppx_deriving_runtime.string) =
      fun x -> Ppx_deriving_runtime.Format.asprintf "%a" pp_unaryop x
    [@@ocaml.warning "-32"]
    let _ = pp_unaryop
    and _ = show_unaryop
  end[@@ocaml.doc "@inline"][@@merlin.hide ]
type ('a, 'b) expr =
  | Fail of 'b data * string 
  | Var of 'b data * 'a 
  | MGlobal of 'b data * 'a typ uuid * 'a 
  | Int of 'b data * string 
  | String of 'b data * string 
  | Char of 'b data * string 
  | Float of 'b data * string 
  | Bool of 'b data * bool 
  | LetIn of 'b data * 'a case * 'a typ option * ('a, 'b) expr * ('a, 
  'b) expr 
  | Seq of 'b data * ('a, 'b) expr * ('a, 'b) expr 
  | Funccall of 'b data * ('a, 'b) expr * ('a, 'b) expr 
  | Binop of 'b data * binop * ('a, 'b) expr * ('a, 'b) expr 
  | UnaryOp of 'b data * unaryop * ('a, 'b) expr 
  | Lambda of 'b data * 'a * 'a typ option * ('a, 'b) expr 
  | Tuple of 'b data * ('a, 'b) expr list 
  | Annot of 'b data * ('a, 'b) expr * 'a typ 
  | Match of 'b data * ('a, 'b) expr * ('a case * ('a, 'b) expr) list 
  | Modify of 'b data * 'a * ('a, 'b) expr 
  | Record of 'b data * 'a * ('a * ('a, 'b) expr) list [@@deriving
                                                         show
                                                           {
                                                             with_path =
                                                               false
                                                           }]
include
  struct
    let _ = fun (_ : ('a, 'b) expr) -> ()
    let rec (pp_expr :
              'a 'b .
                (Ppx_deriving_runtime.Format.formatter ->
                   'a -> Ppx_deriving_runtime.unit)
                  ->
                  (Ppx_deriving_runtime.Format.formatter ->
                     'b -> Ppx_deriving_runtime.unit)
                    ->
                    Ppx_deriving_runtime.Format.formatter ->
                      ('a, 'b) expr -> Ppx_deriving_runtime.unit)
      =
      ((let __43 = pp_expr
        and __42 = pp_data
        and __41 = pp_expr
        and __40 = pp_data
        and __39 = pp_expr
        and __38 = pp_case
        and __37 = pp_expr
        and __36 = pp_data
        and __35 = pp_typ
        and __34 = pp_expr
        and __33 = pp_data
        and __32 = pp_expr
        and __31 = pp_data
        and __30 = pp_expr
        and __29 = pp_typ
        and __28 = pp_data
        and __27 = pp_expr
        and __26 = pp_unaryop
        and __25 = pp_data
        and __24 = pp_expr
        and __23 = pp_expr
        and __22 = pp_binop
        and __21 = pp_data
        and __20 = pp_expr
        and __19 = pp_expr
        and __18 = pp_data
        and __17 = pp_expr
        and __16 = pp_expr
        and __15 = pp_data
        and __14 = pp_expr
        and __13 = pp_expr
        and __12 = pp_typ
        and __11 = pp_case
        and __10 = pp_data
        and __9 = pp_data
        and __8 = pp_data
        and __7 = pp_data
        and __6 = pp_data
        and __5 = pp_data
        and __4 = pp_uuid
        and __3 = pp_typ
        and __2 = pp_data
        and __1 = pp_data
        and __0 = pp_data in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun poly_b ->
                fun fmt ->
                  function
                  | Fail (a0, a1) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>Fail (@,";
                       ((__0 (fun fmt -> poly_b fmt) fmt) a0;
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (Ppx_deriving_runtime.Format.fprintf fmt "%S") a1);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | Var (a0, a1) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>Var (@,";
                       ((__1 (fun fmt -> poly_b fmt) fmt) a0;
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (poly_a fmt) a1);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | MGlobal (a0, a1, a2) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>MGlobal (@,";
                       (((__2 (fun fmt -> poly_b fmt) fmt) a0;
                         Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                         (__4 (fun fmt -> __3 (fun fmt -> poly_a fmt) fmt)
                            fmt) a1);
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (poly_a fmt) a2);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | Int (a0, a1) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>Int (@,";
                       ((__5 (fun fmt -> poly_b fmt) fmt) a0;
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (Ppx_deriving_runtime.Format.fprintf fmt "%S") a1);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | String (a0, a1) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>String (@,";
                       ((__6 (fun fmt -> poly_b fmt) fmt) a0;
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (Ppx_deriving_runtime.Format.fprintf fmt "%S") a1);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | Char (a0, a1) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>Char (@,";
                       ((__7 (fun fmt -> poly_b fmt) fmt) a0;
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (Ppx_deriving_runtime.Format.fprintf fmt "%S") a1);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | Float (a0, a1) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>Float (@,";
                       ((__8 (fun fmt -> poly_b fmt) fmt) a0;
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (Ppx_deriving_runtime.Format.fprintf fmt "%S") a1);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | Bool (a0, a1) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>Bool (@,";
                       ((__9 (fun fmt -> poly_b fmt) fmt) a0;
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (Ppx_deriving_runtime.Format.fprintf fmt "%B") a1);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | LetIn (a0, a1, a2, a3, a4) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>LetIn (@,";
                       (((((__10 (fun fmt -> poly_b fmt) fmt) a0;
                           Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                           (__11 (fun fmt -> poly_a fmt) fmt) a1);
                          Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                          ((function
                            | None ->
                                Ppx_deriving_runtime.Format.pp_print_string
                                  fmt "None"
                            | Some x ->
                                (Ppx_deriving_runtime.Format.pp_print_string
                                   fmt "(Some ";
                                 (__12 (fun fmt -> poly_a fmt) fmt) x;
                                 Ppx_deriving_runtime.Format.pp_print_string
                                   fmt ")"))) a2);
                         Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                         (__13 (fun fmt -> poly_a fmt)
                            (fun fmt -> poly_b fmt) fmt) a3);
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (__14 (fun fmt -> poly_a fmt) (fun fmt -> poly_b fmt)
                           fmt) a4);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | Seq (a0, a1, a2) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>Seq (@,";
                       (((__15 (fun fmt -> poly_b fmt) fmt) a0;
                         Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                         (__16 (fun fmt -> poly_a fmt)
                            (fun fmt -> poly_b fmt) fmt) a1);
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (__17 (fun fmt -> poly_a fmt) (fun fmt -> poly_b fmt)
                           fmt) a2);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | Funccall (a0, a1, a2) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>Funccall (@,";
                       (((__18 (fun fmt -> poly_b fmt) fmt) a0;
                         Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                         (__19 (fun fmt -> poly_a fmt)
                            (fun fmt -> poly_b fmt) fmt) a1);
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (__20 (fun fmt -> poly_a fmt) (fun fmt -> poly_b fmt)
                           fmt) a2);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | Binop (a0, a1, a2, a3) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>Binop (@,";
                       ((((__21 (fun fmt -> poly_b fmt) fmt) a0;
                          Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                          (__22 fmt) a1);
                         Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                         (__23 (fun fmt -> poly_a fmt)
                            (fun fmt -> poly_b fmt) fmt) a2);
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (__24 (fun fmt -> poly_a fmt) (fun fmt -> poly_b fmt)
                           fmt) a3);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | UnaryOp (a0, a1, a2) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>UnaryOp (@,";
                       (((__25 (fun fmt -> poly_b fmt) fmt) a0;
                         Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                         (__26 fmt) a1);
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (__27 (fun fmt -> poly_a fmt) (fun fmt -> poly_b fmt)
                           fmt) a2);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | Lambda (a0, a1, a2, a3) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>Lambda (@,";
                       ((((__28 (fun fmt -> poly_b fmt) fmt) a0;
                          Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                          (poly_a fmt) a1);
                         Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                         ((function
                           | None ->
                               Ppx_deriving_runtime.Format.pp_print_string
                                 fmt "None"
                           | Some x ->
                               (Ppx_deriving_runtime.Format.pp_print_string
                                  fmt "(Some ";
                                (__29 (fun fmt -> poly_a fmt) fmt) x;
                                Ppx_deriving_runtime.Format.pp_print_string
                                  fmt ")"))) a2);
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (__30 (fun fmt -> poly_a fmt) (fun fmt -> poly_b fmt)
                           fmt) a3);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | Tuple (a0, a1) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>Tuple (@,";
                       ((__31 (fun fmt -> poly_b fmt) fmt) a0;
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        ((fun x ->
                            Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                            ignore
                              (List.fold_left
                                 (fun sep x ->
                                    if sep
                                    then
                                      Ppx_deriving_runtime.Format.fprintf fmt
                                        ";@ ";
                                    (__32 (fun fmt -> poly_a fmt)
                                       (fun fmt -> poly_b fmt) fmt) x;
                                    true) false x);
                            Ppx_deriving_runtime.Format.fprintf fmt "@,]@]"))
                          a1);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | Annot (a0, a1, a2) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>Annot (@,";
                       (((__33 (fun fmt -> poly_b fmt) fmt) a0;
                         Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                         (__34 (fun fmt -> poly_a fmt)
                            (fun fmt -> poly_b fmt) fmt) a1);
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (__35 (fun fmt -> poly_a fmt) fmt) a2);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | Match (a0, a1, a2) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>Match (@,";
                       (((__36 (fun fmt -> poly_b fmt) fmt) a0;
                         Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                         (__37 (fun fmt -> poly_a fmt)
                            (fun fmt -> poly_b fmt) fmt) a1);
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        ((fun x ->
                            Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                            ignore
                              (List.fold_left
                                 (fun sep x ->
                                    if sep
                                    then
                                      Ppx_deriving_runtime.Format.fprintf fmt
                                        ";@ ";
                                    ((fun (a0, a1) ->
                                        Ppx_deriving_runtime.Format.fprintf
                                          fmt "(@[";
                                        ((__38 (fun fmt -> poly_a fmt) fmt)
                                           a0;
                                         Ppx_deriving_runtime.Format.fprintf
                                           fmt ",@ ";
                                         (__39 (fun fmt -> poly_a fmt)
                                            (fun fmt -> poly_b fmt) fmt) a1);
                                        Ppx_deriving_runtime.Format.fprintf
                                          fmt "@])")) x;
                                    true) false x);
                            Ppx_deriving_runtime.Format.fprintf fmt "@,]@]"))
                          a2);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | Modify (a0, a1, a2) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>Modify (@,";
                       (((__40 (fun fmt -> poly_b fmt) fmt) a0;
                         Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                         (poly_a fmt) a1);
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        (__41 (fun fmt -> poly_a fmt) (fun fmt -> poly_b fmt)
                           fmt) a2);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                  | Record (a0, a1, a2) ->
                      (Ppx_deriving_runtime.Format.fprintf fmt
                         "(@[<2>Record (@,";
                       (((__42 (fun fmt -> poly_b fmt) fmt) a0;
                         Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                         (poly_a fmt) a1);
                        Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                        ((fun x ->
                            Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                            ignore
                              (List.fold_left
                                 (fun sep x ->
                                    if sep
                                    then
                                      Ppx_deriving_runtime.Format.fprintf fmt
                                        ";@ ";
                                    ((fun (a0, a1) ->
                                        Ppx_deriving_runtime.Format.fprintf
                                          fmt "(@[";
                                        ((poly_a fmt) a0;
                                         Ppx_deriving_runtime.Format.fprintf
                                           fmt ",@ ";
                                         (__43 (fun fmt -> poly_a fmt)
                                            (fun fmt -> poly_b fmt) fmt) a1);
                                        Ppx_deriving_runtime.Format.fprintf
                                          fmt "@])")) x;
                                    true) false x);
                            Ppx_deriving_runtime.Format.fprintf fmt "@,]@]"))
                          a2);
                       Ppx_deriving_runtime.Format.fprintf fmt "@,))@]"))
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_expr :
          'a 'b .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              ->
              (Ppx_deriving_runtime.Format.formatter ->
                 'b -> Ppx_deriving_runtime.unit)
                -> ('a, 'b) expr -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun poly_b ->
          fun x ->
            Ppx_deriving_runtime.Format.asprintf "%a"
              ((pp_expr poly_a) poly_b) x[@@ocaml.warning "-32"]
    let _ = pp_expr
    and _ = show_expr
  end[@@ocaml.doc "@inline"][@@merlin.hide ]
let get_data (e : ('a, 'b) expr) : 'b data=
  match e with
  | Fail (i, _) | MGlobal (i, _, _) | Var (i, _) | Int (i, _) | String 
    (i, _) | Char (i, _) | Float (i, _) | Bool (i, _) | LetIn (i, _, _, _, _)
    | Seq (i, _, _) | Funccall (i, _, _) | Binop (i, _, _, _) | Lambda
    (i, _, _, _) | Tuple (i, _) | Annot (i, _, _) | Match (i, _, _) | UnaryOp
    (i, _, _) | Modify (i, _, _) | Record (i, _, _) -> i
let get_uuid x = (get_data x).uuid
let data_transform (type a) (type b) (f : a data -> b data) expr =
  let rec go e =
    match e with
    | Fail (d, s) -> Fail ((f d), s)
    | MGlobal (d, p, s) -> MGlobal ((f d), p, s)
    | Var (i, s) -> Var ((f i), s)
    | Int (i, s) -> Int ((f i), s)
    | String (i, s) -> String ((f i), s)
    | Char (i, s) -> Char ((f i), s)
    | Float (i, s) -> Float ((f i), s)
    | Bool (i, s) -> Bool ((f i), s)
    | LetIn (i, c, ty, e1, e2) -> LetIn ((f i), c, ty, (go e1), (go e2))
    | Seq (i, a, b) -> Seq ((f i), (go a), (go b))
    | Funccall (i, a, b) -> Funccall ((f i), (go a), (go b))
    | Binop (i, b, e1, e2) -> Binop ((f i), b, (go e1), (go e2))
    | Lambda (i, nm, t, e) -> Lambda ((f i), nm, t, (go e))
    | Tuple (i, s) -> Tuple ((f i), (List.map go s))
    | Annot (i, e, t) -> Annot ((f i), (go e), t)
    | Match (i, e, cs) ->
        Match ((f i), (go e), (List.map (fun (b, a) -> (b, (go a))) cs))
    | UnaryOp (i, a, e) -> UnaryOp ((f i), a, (go e))
    | Modify (i, a, e) -> Modify ((f i), a, (go e))
    | Record (i, a, cs) ->
        Record ((f i), a, (List.map (fun (a, b) -> (a, (go b))) cs)) in
  go expr
let expr_uuid_set_snd v expr =
  let f d = { d with uuid = (Share.Uuid.uuid_set_snd v d.uuid) } in
  data_transform f expr
type 'a typdef_case =
  | Record of 'a field list 
  | Sum of ('a * 'a typ list) list [@@deriving show { with_path = false }]
include
  struct
    let _ = fun (_ : 'a typdef_case) -> ()
    let rec (pp_typdef_case :
              'a .
                (Ppx_deriving_runtime.Format.formatter ->
                   'a -> Ppx_deriving_runtime.unit)
                  ->
                  Ppx_deriving_runtime.Format.formatter ->
                    'a typdef_case -> Ppx_deriving_runtime.unit)
      =
      ((let __1 = pp_typ
        and __0 = pp_field in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun fmt ->
                function
                | Record a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>Record@ ";
                     ((fun x ->
                         Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                         ignore
                           (List.fold_left
                              (fun sep x ->
                                 if sep
                                 then
                                   Ppx_deriving_runtime.Format.fprintf fmt
                                     ";@ ";
                                 (__0 (fun fmt -> poly_a fmt) fmt) x;
                                 true) false x);
                         Ppx_deriving_runtime.Format.fprintf fmt "@,]@]")) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])")
                | Sum a0 ->
                    (Ppx_deriving_runtime.Format.fprintf fmt "(@[<2>Sum@ ";
                     ((fun x ->
                         Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                         ignore
                           (List.fold_left
                              (fun sep x ->
                                 if sep
                                 then
                                   Ppx_deriving_runtime.Format.fprintf fmt
                                     ";@ ";
                                 ((fun (a0, a1) ->
                                     Ppx_deriving_runtime.Format.fprintf fmt
                                       "(@[";
                                     ((poly_a fmt) a0;
                                      Ppx_deriving_runtime.Format.fprintf fmt
                                        ",@ ";
                                      ((fun x ->
                                          Ppx_deriving_runtime.Format.fprintf
                                            fmt "@[<2>[";
                                          ignore
                                            (List.fold_left
                                               (fun sep x ->
                                                  if sep
                                                  then
                                                    Ppx_deriving_runtime.Format.fprintf
                                                      fmt ";@ ";
                                                  (__1
                                                     (fun fmt -> poly_a fmt)
                                                     fmt) x;
                                                  true) false x);
                                          Ppx_deriving_runtime.Format.fprintf
                                            fmt "@,]@]")) a1);
                                     Ppx_deriving_runtime.Format.fprintf fmt
                                       "@])")) x;
                                 true) false x);
                         Ppx_deriving_runtime.Format.fprintf fmt "@,]@]")) a0;
                     Ppx_deriving_runtime.Format.fprintf fmt "@])"))
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_typdef_case :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              -> 'a typdef_case -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun x ->
          Ppx_deriving_runtime.Format.asprintf "%a" (pp_typdef_case poly_a) x
    [@@ocaml.warning "-32"]
    let _ = pp_typdef_case
    and _ = show_typdef_case
  end[@@ocaml.doc "@inline"][@@merlin.hide ]
let rec typ_list_to_typ (t : 'a typ list) : 'a typ=
  match t with
  | [] -> failwith "empty typ"
  | x::[] -> x
  | x::xs -> TyArrow (x, (typ_list_to_typ xs))
let typ_to_args_ret (typ : 'a typ) : ('a typ list * 'a typ)=
  let rec go ty =
    match ty with
    | TyArrow (a, TyArrow (b, c)) ->
        let (rest, tl) = go (TyArrow (b, c)) in ((a :: rest), tl)
    | TyArrow (a, b) -> ([a], b)
    | other -> ([], other) in
  go typ
type 'a typdef =
  {
  data: unit data ;
  name: 'a ;
  args: 'a list ;
  content: 'a typdef_case }[@@deriving show { with_path = false }]
include
  struct
    let _ = fun (_ : 'a typdef) -> ()
    let rec (pp_typdef :
              'a .
                (Ppx_deriving_runtime.Format.formatter ->
                   'a -> Ppx_deriving_runtime.unit)
                  ->
                  Ppx_deriving_runtime.Format.formatter ->
                    'a typdef -> Ppx_deriving_runtime.unit)
      =
      ((let __1 = pp_typdef_case
        and __0 = pp_data in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun fmt x ->
                Ppx_deriving_runtime.Format.fprintf fmt "@[<2>{ ";
                ((((Ppx_deriving_runtime.Format.fprintf fmt "@[%s =@ " "data";
                    (__0
                       (fun fmt () ->
                          Ppx_deriving_runtime.Format.pp_print_string fmt
                            "()") fmt) x.data;
                    Ppx_deriving_runtime.Format.fprintf fmt "@]");
                   Ppx_deriving_runtime.Format.fprintf fmt ";@ ";
                   Ppx_deriving_runtime.Format.fprintf fmt "@[%s =@ " "name";
                   (poly_a fmt) x.name;
                   Ppx_deriving_runtime.Format.fprintf fmt "@]");
                  Ppx_deriving_runtime.Format.fprintf fmt ";@ ";
                  Ppx_deriving_runtime.Format.fprintf fmt "@[%s =@ " "args";
                  ((fun x ->
                      Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                      ignore
                        (List.fold_left
                           (fun sep x ->
                              if sep
                              then
                                Ppx_deriving_runtime.Format.fprintf fmt ";@ ";
                              (poly_a fmt) x;
                              true) false x);
                      Ppx_deriving_runtime.Format.fprintf fmt "@,]@]"))
                    x.args;
                  Ppx_deriving_runtime.Format.fprintf fmt "@]");
                 Ppx_deriving_runtime.Format.fprintf fmt ";@ ";
                 Ppx_deriving_runtime.Format.fprintf fmt "@[%s =@ " "content";
                 (__1 (fun fmt -> poly_a fmt) fmt) x.content;
                 Ppx_deriving_runtime.Format.fprintf fmt "@]");
                Ppx_deriving_runtime.Format.fprintf fmt "@ }@]")
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_typdef :
          'a .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              -> 'a typdef -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun x ->
          Ppx_deriving_runtime.Format.asprintf "%a" (pp_typdef poly_a) x
    [@@ocaml.warning "-32"]
    let _ = pp_typdef
    and _ = show_typdef
  end[@@ocaml.doc "@inline"][@@merlin.hide ]
let typdef_and_ctor_to_typ (t : 'a typdef) (i : 'a) : 'a typ=
  match t.content with
  | Record _ -> failwith "shouldn't be record"
  | Sum s ->
      let ctor = List.assoc i s in
      let custom = TyCustom (t.name, (List.map (fun x -> TyPoly x) t.args)) in
      typ_list_to_typ (ctor @ [custom])
type ('a, 'b, 'p) definition =
  {
  data: 'b data ;
  name: 'a ;
  typeargs: 'a list ;
  args: ('a * 'a typ) list ;
  return: 'a typ ;
  body: (('a, 'b) expr, 'p) maybe }[@@deriving show { with_path = false }]
include
  struct
    let _ = fun (_ : ('a, 'b, 'p) definition) -> ()
    let rec (pp_definition :
              'a 'b 'p .
                (Ppx_deriving_runtime.Format.formatter ->
                   'a -> Ppx_deriving_runtime.unit)
                  ->
                  (Ppx_deriving_runtime.Format.formatter ->
                     'b -> Ppx_deriving_runtime.unit)
                    ->
                    (Ppx_deriving_runtime.Format.formatter ->
                       'p -> Ppx_deriving_runtime.unit)
                      ->
                      Ppx_deriving_runtime.Format.formatter ->
                        ('a, 'b, 'p) definition -> Ppx_deriving_runtime.unit)
      =
      ((let __4 = pp_maybe
        and __3 = pp_expr
        and __2 = pp_typ
        and __1 = pp_typ
        and __0 = pp_data in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun poly_b ->
                fun poly_p ->
                  fun fmt x ->
                    Ppx_deriving_runtime.Format.fprintf fmt "@[<2>{ ";
                    ((((((Ppx_deriving_runtime.Format.fprintf fmt "@[%s =@ "
                            "data";
                          (__0 (fun fmt -> poly_b fmt) fmt) x.data;
                          Ppx_deriving_runtime.Format.fprintf fmt "@]");
                         Ppx_deriving_runtime.Format.fprintf fmt ";@ ";
                         Ppx_deriving_runtime.Format.fprintf fmt "@[%s =@ "
                           "name";
                         (poly_a fmt) x.name;
                         Ppx_deriving_runtime.Format.fprintf fmt "@]");
                        Ppx_deriving_runtime.Format.fprintf fmt ";@ ";
                        Ppx_deriving_runtime.Format.fprintf fmt "@[%s =@ "
                          "typeargs";
                        ((fun x ->
                            Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                            ignore
                              (List.fold_left
                                 (fun sep x ->
                                    if sep
                                    then
                                      Ppx_deriving_runtime.Format.fprintf fmt
                                        ";@ ";
                                    (poly_a fmt) x;
                                    true) false x);
                            Ppx_deriving_runtime.Format.fprintf fmt "@,]@]"))
                          x.typeargs;
                        Ppx_deriving_runtime.Format.fprintf fmt "@]");
                       Ppx_deriving_runtime.Format.fprintf fmt ";@ ";
                       Ppx_deriving_runtime.Format.fprintf fmt "@[%s =@ "
                         "args";
                       ((fun x ->
                           Ppx_deriving_runtime.Format.fprintf fmt "@[<2>[";
                           ignore
                             (List.fold_left
                                (fun sep x ->
                                   if sep
                                   then
                                     Ppx_deriving_runtime.Format.fprintf fmt
                                       ";@ ";
                                   ((fun (a0, a1) ->
                                       Ppx_deriving_runtime.Format.fprintf
                                         fmt "(@[";
                                       ((poly_a fmt) a0;
                                        Ppx_deriving_runtime.Format.fprintf
                                          fmt ",@ ";
                                        (__1 (fun fmt -> poly_a fmt) fmt) a1);
                                       Ppx_deriving_runtime.Format.fprintf
                                         fmt "@])")) x;
                                   true) false x);
                           Ppx_deriving_runtime.Format.fprintf fmt "@,]@]"))
                         x.args;
                       Ppx_deriving_runtime.Format.fprintf fmt "@]");
                      Ppx_deriving_runtime.Format.fprintf fmt ";@ ";
                      Ppx_deriving_runtime.Format.fprintf fmt "@[%s =@ "
                        "return";
                      (__2 (fun fmt -> poly_a fmt) fmt) x.return;
                      Ppx_deriving_runtime.Format.fprintf fmt "@]");
                     Ppx_deriving_runtime.Format.fprintf fmt ";@ ";
                     Ppx_deriving_runtime.Format.fprintf fmt "@[%s =@ "
                       "body";
                     (__4
                        (fun fmt ->
                           __3 (fun fmt -> poly_a fmt)
                             (fun fmt -> poly_b fmt) fmt)
                        (fun fmt -> poly_p fmt) fmt) x.body;
                     Ppx_deriving_runtime.Format.fprintf fmt "@]");
                    Ppx_deriving_runtime.Format.fprintf fmt "@ }@]")
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_definition :
          'a 'b 'p .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              ->
              (Ppx_deriving_runtime.Format.formatter ->
                 'b -> Ppx_deriving_runtime.unit)
                ->
                (Ppx_deriving_runtime.Format.formatter ->
                   'p -> Ppx_deriving_runtime.unit)
                  -> ('a, 'b, 'p) definition -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun poly_b ->
          fun poly_p ->
            fun x ->
              Ppx_deriving_runtime.Format.asprintf "%a"
                (((pp_definition poly_a) poly_b) poly_p) x[@@ocaml.warning
                                                            "-32"]
    let _ = pp_definition
    and _ = show_definition
  end[@@ocaml.doc "@inline"][@@merlin.hide ]
let forget_body : ('a, 'b, yes) definition -> ('a, 'b, no) definition =
  fun x -> { x with body = Nothing }
let conjur_body :
  ('a, 'b, 'd) definition -> ('a, 'b) expr -> ('a, 'b, yes) definition =
  fun x b -> { x with body = (Just b) }
let definition_type (type a) (d : ('a, 'b, a) definition) : 'a typ=
  List.fold_right (fun (_, ty) acc -> TyArrow (ty, acc)) d.args d.return
type ('a, 'b, 'c) toplevel =
  | Module: 'a * ('a, 'b, 'c) toplevel list -> ('a, 'b, unit) toplevel 
  | Typdef: 'a typdef -> ('a, 'b, 'c) toplevel 
  | Definition: ('a, 'b, yes) definition -> ('a, 'b, 'c) toplevel 
  | Open: 'a -> ('a, 'b, unit) toplevel [@@deriving
                                          show { with_path = false }]
include
  struct
    let _ = fun (_ : ('a, 'b, 'c) toplevel) -> ()
    let rec (pp_toplevel :
              'a 'b 'c .
                (Ppx_deriving_runtime.Format.formatter ->
                   'a -> Ppx_deriving_runtime.unit)
                  ->
                  (Ppx_deriving_runtime.Format.formatter ->
                     'b -> Ppx_deriving_runtime.unit)
                    ->
                    (Ppx_deriving_runtime.Format.formatter ->
                       'c -> Ppx_deriving_runtime.unit)
                      ->
                      Ppx_deriving_runtime.Format.formatter ->
                        ('a, 'b, 'c) toplevel -> Ppx_deriving_runtime.unit)
      =
      ((let __3 = pp_definition
        and __2 = pp_yes
        and __1 = pp_typdef
        and __0 = pp_toplevel in
        ((let open! ((Ppx_deriving_runtime)[@ocaml.warning "-A"]) in
            fun poly_a ->
              fun poly_b ->
                fun poly_c ->
                  fun fmt ->
                    function
                    | Module (a0, a1) ->
                        (Ppx_deriving_runtime.Format.fprintf fmt
                           "(@[<2>Module (@,";
                         ((poly_a fmt) a0;
                          Ppx_deriving_runtime.Format.fprintf fmt ",@ ";
                          ((fun x ->
                              Ppx_deriving_runtime.Format.fprintf fmt
                                "@[<2>[";
                              ignore
                                (List.fold_left
                                   (fun sep x ->
                                      if sep
                                      then
                                        Ppx_deriving_runtime.Format.fprintf
                                          fmt ";@ ";
                                      (__0 (fun fmt -> poly_a fmt)
                                         (fun fmt -> poly_b fmt)
                                         (fun fmt -> poly_c fmt) fmt) x;
                                      true) false x);
                              Ppx_deriving_runtime.Format.fprintf fmt "@,]@]"))
                            a1);
                         Ppx_deriving_runtime.Format.fprintf fmt "@,))@]")
                    | Typdef a0 ->
                        (Ppx_deriving_runtime.Format.fprintf fmt
                           "(@[<2>Typdef@ ";
                         (__1 (fun fmt -> poly_a fmt) fmt) a0;
                         Ppx_deriving_runtime.Format.fprintf fmt "@])")
                    | Definition a0 ->
                        (Ppx_deriving_runtime.Format.fprintf fmt
                           "(@[<2>Definition@ ";
                         (__3 (fun fmt -> poly_a fmt) (fun fmt -> poly_b fmt)
                            (fun fmt -> __2 fmt) fmt) a0;
                         Ppx_deriving_runtime.Format.fprintf fmt "@])")
                    | Open a0 ->
                        (Ppx_deriving_runtime.Format.fprintf fmt
                           "(@[<2>Open@ ";
                         (poly_a fmt) a0;
                         Ppx_deriving_runtime.Format.fprintf fmt "@])"))
          [@ocaml.warning "-A"]))
      [@ocaml.warning "-39"])
    and (show_toplevel :
          'a 'b 'c .
            (Ppx_deriving_runtime.Format.formatter ->
               'a -> Ppx_deriving_runtime.unit)
              ->
              (Ppx_deriving_runtime.Format.formatter ->
                 'b -> Ppx_deriving_runtime.unit)
                ->
                (Ppx_deriving_runtime.Format.formatter ->
                   'c -> Ppx_deriving_runtime.unit)
                  -> ('a, 'b, 'c) toplevel -> Ppx_deriving_runtime.string)
      =
      fun poly_a ->
        fun poly_b ->
          fun poly_c ->
            fun x ->
              Ppx_deriving_runtime.Format.asprintf "%a"
                (((pp_toplevel poly_a) poly_b) poly_c) x[@@ocaml.warning
                                                          "-32"]
    let _ = pp_toplevel
    and _ = show_toplevel
  end[@@ocaml.doc "@inline"][@@merlin.hide ]
File "_none_", line 1:
Error: Unbound module Share
Hint:    Did you mean Char?
